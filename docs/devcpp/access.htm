<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
	<TITLE>Dev-C++ and SPTK</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.1  (Linux)">
	<META NAME="CREATED" CONTENT="20040530;7265400">
	<META NAME="CHANGED" CONTENT="20040530;7313300">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>Compile your first SPDB Project with DevC++ and Microsoft Access</H1>
<P>(If you find an error in this Howto please let me know via email
at andreasbresser (at) gmx (dot) de) <BR><BR>1. Create an Access
Database.<BR>1.1 Start Microsoft Access.<BR>1.2 Click on File -&gt;
New.<BR>(The new Database-Window appears).<BR>1.3 Select any folder
and click on Create.<BR>1.4 Close MS Access.<BR><BR>2. Create an ODBC
Connection to your Database 2.1 Click on Start -&gt; Settings -&gt;
Control Panel.<BR>2.2 Once you are in the Control Panel, double-click
on &quot;ODBC Data Sources or 32-bit ODBC&quot;.<BR>2.3 click on the
&quot;Add...&quot; button. <BR>2.4 Now the &quot;Create New Data
Source&quot; window appears.<BR>2.5 Select &quot;Microsoft Access
Driver (*.mdb)&quot; and click on &quot;Finish&quot; <BR>Now the
&quot;ODBC Microsoft Access Setup&quot; Window appears.<BR>2.6 The
&quot;Data Source Name&quot; must be &quot;odbc_demo&quot; (you can
of course use another name for your own Projects).<BR>2.7 Click on
&quot;Select&quot; in the Database section and select your
Database.<BR>2.8 Click on &quot;OK&quot; (When you get a
&quot;File-not-found&quot; error close Microsoft Access and make sure
that nobody is connected to this database).<BR>2.9 now you can see a
new entry in the &quot;User Data Source&quot; window.<BR>2.10 Click
on &quot;OK&quot;.<BR><BR><BR>2. Compile your first SPDB program.<BR>2.1
start Dev-C++<BR>2.2 Click on &quot;File&quot; -&gt; &quot;Import&quot;
-&gt; &quot;Import MS Visual C++ Project&quot;.<BR>2.3 Click on
&quot;...&quot;.<BR>2.4 Select the file sptk-x.x\VC6\db_list_view.dsp
(x.x is the SPTK-Version number) and click on &quot;Open&quot;<BR>2.5
Click on &quot;Import&quot;.<BR>2.6 Click on &quot;Yes&quot;.<BR>2.7
Press ALT+P.<BR>2.8 (VERY IMPORTANT) Select &quot;Win32 Console&quot;
in the &quot;Type&quot; Section!!!<BR>2.9 Click on &quot;Parameters&quot;.<BR>2.10
Click on &quot;Add Library or Object&quot; under the
&quot;Linker&quot;-Textbox.<BR>2.11 Select the file SPTKlib.a form
the devcpp/lib directory.<BR>2.12 Click on &quot;Open&quot;.<BR>2.13
Repeat 2.10 to 2.12 with the files libfltk.a, libfltk_forms.a,
libfltk_images.a, <B>libodbc32.a, libodbcpp32.a</B> and
libfltk_gl.a<BR><IMG SRC="images/odbc-linker.jpg" NAME="Graphic1" ALIGN=BOTTOM WIDTH=477 HEIGHT=340 BORDER=0><BR>(should
look like this ;-))<BR><BR><BR>2.14 Compile and run the Program
(press F9) -&gt; a DOS-Box will appear and close immediately.<BR><BR><BR>3.
Examine your compiled Program<BR>3.1 Run a MS-DOS Box (click on
&quot;Start&quot;-&gt;&quot;Run&quot; and open command.exe (under
Windows 2000/XP you must open cmd.exe))<BR>3.2 Go into your
SPTK-x.x\VC6 directory (cd sptk-2.2alpha\vc6).<BR>3.3 Type
&quot;db_list_view&quot; and press enter<BR>3.4 Now you (may be) see
this error:<BR><IMG SRC="images/dos_box_error_a.jpg" NAME="Graphic2" ALIGN=BOTTOM WIDTH=812 HEIGHT=459 BORDER=0><BR>This
is because my Microsoft Access version (Access 2002) does not
understand the &quot;TEMP&quot; command in the MySQL-Syntax. So I
change the original Source a bit :-):<BR>First, I removed the &quot;TEMP&quot;
in line 106.<BR>Then, I added The following line:<BR>&nbsp;&nbsp;&nbsp;&nbsp;
CQuery&nbsp;&nbsp;&nbsp;&nbsp;query0(&amp;db,&quot;DROP TABLE IF
EXISTS companies&quot;);<BR>This creates a new CQuery called query0.
<BR>To execute this Query I added this line:<BR>&nbsp;&nbsp;&nbsp;&nbsp;query0.exec();<BR>The
edited program should look like this (I have underlined my changes in
green):<BR><IMG SRC="images/edited_odbc_test.jpg" NAME="Graphic3" ALIGN=BOTTOM WIDTH=864 HEIGHT=532 BORDER=0><BR>3.5
Recompile and run your Program (F9). Now you should see
this:<BR><IMG SRC="images/odbc_success.jpg" NAME="Graphic4" ALIGN=BOTTOM WIDTH=506 HEIGHT=425 BORDER=0><BR>Congratulations!
You have successfully compiled a SPDB program with Dev-C++.<BR><BR>If
you want to compile and run any other SPTK-Samples (like the
sptk_test or odbc_demo) you need to include all SPTK, FLTK and ODBC
libraries and (maybe) change the SQL-Syntax (remove the &quot;TEMP&quot;
and add an &quot;DROP TABLE IF EXISTS&quot;-Query if you get
MySQL-Errors).<BR>When your program runs fine you can change the Type
from Win32Console to Win32Gui (Press ALT+P and click on Win32GUI),
but than the SQL-Errors will not be shown to the user. 
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in">by Andreas Bresser
andreasbresser (at) gmx (dot) de</P>
</BODY>
</HTML>